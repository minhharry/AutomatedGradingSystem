# Gemini Automated Grading System

This project provides an automated grading system using Google's Gemini API, built with Gradio for a user-friendly interface. It allows educators to quickly grade multiple student submissions (e.g., Python files, PDFs, text files) against a defined exercise problem statement.

## Features

*   **Automated Grading:** Leverages the Gemini API to evaluate student submissions based on provided exercise problems.
*   **Multiple File Support:** Grades various file types, including `.pdf`, `.py`, and `.txt`.
*   **Folder Scanning:** Recursively scans a specified folder for submission files.
*   **Detailed Feedback:** Provides constructive feedback and a numerical grade for each exercise.
*   **CSV Export:** Exports comprehensive grading results to a CSV file, including individual exercise grades and feedback.
*   **Retry Mechanism:** Allows retrying individual failed submissions or all failed submissions.
*   **User-Friendly Interface:** Built with Gradio for an intuitive web interface.

## Docx to PDF Conversion (Optional)

The Gemini API does not directly accept `.docx` files for grading. If your student submissions are in `.docx` format, you can use the [`doctopdf.py`](doctopdf.py) utility script to convert them to `.pdf` files before grading.

1.  **Configure Input and Output Directories:**
    Open [`doctopdf.py`](doctopdf.py) and modify the `INPUT_DIRECTORY` and `OUTPUT_DIRECTORY` variables to specify where your `.docx` files are located and where the converted `.pdf` files should be saved.

    ```python
    # Set your directories here:
    INPUT_DIRECTORY = "input_folder"  # <--- SET YOUR INPUT FOLDER (e.g., "C:\\Users\\YourUser\\Documents\\DocxSubmissions")
    OUTPUT_DIRECTORY = "output_folder" # <--- SET YOUR OUTPUT FOLDER (e.g., "C:\\Users\\YourUser\\Documents\\PdfSubmissions")
    ```

2.  **Run the conversion script:**

    ```bash
    python doctopdf.py
    ```
    The script will recursively find all `.docx` files in the `INPUT_DIRECTORY`, convert them to `.pdf`, and save them in the `OUTPUT_DIRECTORY` while maintaining the original folder structure and normalizing filenames.

    Alternatively, you can pass the input and output directories as command-line arguments:

    ```bash
    python doctopdf.py "path/to/your/docx/folder" "path/to/your/output/pdf/folder"
    ```

## Installation

This project uses `uv` as the package manager.

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/minhharry/AutomatedGradingSystem.git
    cd AutomatedGradingSystem
    ```

2.  **Install `uv` (if you don't have it):**
    Refer to the [uv repository](https://github.com/astral-sh/uv) for detailed installation instructions.

    ```bash
    pip install uv
    ```

3.  **Install dependencies:**

    ```bash
    uv sync
    ```

## Usage

1.  **Set up your Gemini API Key:**
    *   Obtain your API key from [Google AI Studio](https://aistudio.google.com/app/apikey).
    *   (Optional) Create a `.env` file in the project root and add your API key:
        ```
        GEMINI_API_KEY="YOUR_GEMINI_API_KEY"
        ```
    *   Alternatively, you can enter the API key directly in the Gradio interface.

2.  **Run the application:**

    ```bash
    python main.py
    ```

3.  **Access the Web Interface:**
    Open your web browser and navigate to the address provided by Gradio (usually `http://127.0.0.1:7860`).

4.  **Grade Submissions:**
    *   **Gemini API Key:** Enter your Gemini API key (if not set in `.env`).
    *   **Submissions Folder Path:** Enter the absolute path to the folder containing student submission files.
    *   **File Extensions to Grade:** Specify the comma-separated file extensions to be graded (e.g., `.py, .pdf, .txt`).
    *   **Exercise Problem Statement(s):** Paste the full exercise problem(s) here. For multiple exercises, list them clearly (e.g., "1. Implement X", "2. Analyze Y"). The AI will grade each one separately.
    *   Click the "ðŸš€ Grade Submissions" button to start the grading process.

5.  **Review Results:**
    *   The "Grading Results" table will display the status, grade, feedback, and any errors for each submission.
    *   A CSV file containing all detailed results will be saved in the specified submissions folder.
    *   You can retry individual failed submissions by clicking the "ðŸ”„ Retry" button in the table.
    *   You can retry all failed submissions by clicking the "ðŸ”„ Retry All Failed" button.

## Project Structure

*   [`main.py`](main.py): The main application logic and Gradio interface.
*   [`doctopdf.py`](doctopdf.py): A utility script to convert `.docx` files to `.pdf` format, as the Gemini API does not directly accept `.docx` files for grading.
*   [`pyproject.toml`](pyproject.toml): Project metadata and dependencies.
*   [`uv.lock`](uv.lock): Lock file generated by `uv` for reproducible environments.
*   `.env`: Environment variables (e.g., `GEMINI_API_KEY`).
*   `debug.log`: Log file for debugging information.

## Dependencies

The project relies on the following Python libraries:

*   `docx2pdf`
*   `dotenv`
*   `google-genai`
*   `gradio`
*   `pandas`
